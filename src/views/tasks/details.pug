extends ../layouts/main.pug

block content
  .row.justify-content-center
    .col-md-8
      .d-flex.justify-content-between.align-items-center.mb-4
        h2 Detalhes da Tarefa
        a.btn.btn-secondary(href="/dashboard") Voltar

      .card.shadow-sm
        .card-body
          .mb-3
            h5.card-title= task.title
          
          .mb-3
            strong Descrição:
            p.card-text= task.description || 'Sem descrição'
          
          .row.mb-3
            .col-md-6
              strong Status:
              p
                - const statusMap = { 'pending': 'Pendente', 'in-progress': 'Em progresso', 'completed': 'Concluída' }
                span.badge(class={
                  'bg-warning': task.status === 'pending',
                  'bg-info': task.status === 'in-progress',
                  'bg-success': task.status === 'completed'
                })= statusMap[task.status] || task.status
            
            .col-md-6
              strong Data de Vencimento:
              p= task.dueDate ? (() => { const d = new Date(task.dueDate); const day = String(d.getUTCDate()).padStart(2, '0'); const month = String(d.getUTCMonth() + 1).padStart(2, '0'); const year = d.getUTCFullYear(); return `${day}/${month}/${year}`; })() : 'Não informado'
          
          .row.mb-3
            .col-md-6
              strong Criada em:
              p= task.createdAt ? new Date(task.createdAt).toLocaleDateString('pt-BR') : '-'
            
            .col-md-6
              strong Atualizada em:
              p= task.updatedAt ? new Date(task.updatedAt).toLocaleDateString('pt-BR') : '-'
          
          if task.userId
            .mb-3
              strong Criada por:
              p= task.userId.name || task.userId.email || '-'
          
          .mt-4
            a.btn.btn-primary.me-2(href=`/tasks/edit/${task._id}`) Editar
            form.d-inline(method="POST" action=`/tasks/delete/${task._id}` onsubmit="return confirm('Tem certeza que deseja excluir esta tarefa?');")
              button.btn.btn-danger(type="submit") Excluir

